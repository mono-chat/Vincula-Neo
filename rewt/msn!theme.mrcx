;MSN Theme - Comment: Once I used this in my early years of scripting, this is a recreation of it.
;By Sky

#MSNColor on
#MSNColor end

menu channel,status,menubar {
  .[MSN!Theme]
  .. $+ $iif($group(#MSNTheme) == on,[Enabled],[Disabled]):{ $iif($group(#MSNTheme) == ON,.disable #MSNTheme,.enable #MSNTheme) | $iif($group(#MSNTheme) == ON,echo -a               14 $+ MSN Theme Enabled.,echo -a               14 $+ MSN Theme Disabled.) }
  .. $+ $iif($group(#MSNTheme) == on,[LabelUserLevels[ $+ $group(#MSNColor) $+ ],$null):{ $iif($group(#MSNColor) == ON,.disable #MSNColor,.enable #MSNColor) | $iif($group(#MSNColor) == ON,echo -a               14 $+ User Level Colouring Enabled.,echo -a               14 $+ User Level Colouring Disabled.) }
}
#MSNTheme on
on ^*:TEXT:*:#:{
  if ($nick == #) { .echo #  3  $1- }
  else { .echo #  $+ $getmycolor($nick,#) $+   0,0 2,0 $+ $nick  :1     $1- }
  halt
}
on *:INPUT:#:{
  var %text = $1-
  if ($group(#colortalk) == on) { %text = $ColourMessage(%text) }
  if ($mid($1-,1,1) != /) { .echo #  $+ $getmycolor($me,#) $+   $+     $+  $+ 2,0 $+   $+ $me  :1  %text | .msg # %text | halt }
}

alias getmycolor {
  if ($group(#MSNColor) == on) {
    if ($$1 isowner $$2) { return 8,8 | halt }
    if ($$1 isop $$2) { return 5,5 | halt }
    if ($$1 !isowner $$2) && ($$1 !isop $$2) && ($$1 isreg $$2) { return 12,12 | halt }
  }
  return 0,0
}

alias me {
  .echo $active   6 $+ $me 6 $+ $1-
  .msg $active ACTION $1- $+ 
}

on ^*:rawMODE:#: {
  var %comment
  if (!$2) || ($1 == +k) || ($1 == -k) || ($1 == +l) || ($1 == -l) {
    .echo #   14 $+ $nick sets mode: $1-
  }
  else {
    if ($1 == +q) {
      %comment = a Owner.
    }
    elseif ($1 == -q) {
      %comment = a Participant.
    }
    elseif ($1 == +o) {
      %comment = a Host.
    }
    elseif ($1 == -o) {
      %comment = a Participant.
    }
    elseif ($1 == +v) {
      %comment = a Participant.
    }
    elseif ($1 == -v) {
      %comment = a Spectator.
    }
    elseif ($1 == +p) {
      %comment = a Participant.
    }
    .echo #               14 $+ $nick Has made $2 %comment
  }
  halt
}

on ^*:KICK:#:{
  .echo #   4 $+ $nick Has kicked $knick out of the room ( $+ $1- $+ 4)
  halt
}

on ^*:JOIN:#:{
  .echo #     14 $+ $nick Has Joined the room.
  halt
}
on ^*:PART:#:{
  .echo #     14 $+ $nick Has Left the room.
  halt
}
on ^*:ACTION:#:{
  .echo #   6 $+ $nick 6 $+ $1-
  halt
}
on ^*:ACTION:?:{
  .echo $active   6 $+ $nick 6 $+ $1-
  halt
}
raw 332:*:{
  .echo $2   10The chat's topic is: 1 $3-
  halt
}
on ^*:TOPIC:#:{
  .echo #   10The chat's topic has changed to: 1 $1- 1( $+ $nick $+ )
  halt
}
raw prop:*:{
  echo $1 14      $nick Props $lower($2) $+ : $3-
}
alias hop {
  ;.echo #  2  Attempting to rejoin.
  .hop #
  halt
}

menu nicklist {
  [View Profile]:{ prop $$1 * }
  -
  $iif($me isowner $active,[Owner],$null) $+ :{ mode # +q $1- }
  $iif($me isop $active,[Host],$null) $+ :{ mode # +o $1- }
  $iif($me isop $active,[Participant],$null) $+ :{ mode # -o $1- }
}
alias ColourMessage {
  var %i = 1
  var %say
  while (%i <= $len($1-)) {
    if ($mid($1-,%i,1) == $chr(32)) {
      %say = %say $+ $chr(32) $+ $chr(32)
    }
    else {
      %say = %say $+ $chr(3) $+ $rand(9,15) $+ $mid($1-,%i,1)
    }
    inc %i
  }
  return %say
}
#colortalk off
#colortalk end
#MSNTheme end
